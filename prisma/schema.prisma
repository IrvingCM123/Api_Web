generator client {
  provider = "prisma-client-js"
}

// Configuración de la fuente de datos, PostgreSQL y URL de la base de datos desde las variables de entorno
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Definición del modelo User
model User {
  // Campo de identificación autoincremental
  ID_Usuario Int @id @default(autoincrement())
  // Campo para la URL de la imagen, opcional
  url_imagen String? @db.VarChar(255)
  // Campo para el nombre de usuario
  Nombre_Usuario String @db.VarChar(30)
  // Campo para el correo de usuario, único
  Correo_Usuario String @unique @db.VarChar(30)
  // Campo para la contraseña de usuario
  Contrasena_Usuario String @db.VarChar(30)
  // Relación con el modelo GestionUsuario
  gestion_usuarios GestionUsuario[]
  // Relación con el modelo PrestamoDevolucion
  prestamos PrestamoDevolucion[]

  // Agrega la relación inversa para historial_prestamo
  historial_prestamo HistorialPrestamo[]
}

// Definición del modelo GestionUsuario
model GestionUsuario {
  // Campo de identificación
  ID_Usuario   Int       @id
  // Relación con el modelo User
  User         User      @relation(fields: [ID_Usuario], references: [ID_Usuario])
  // Campo booleano para Candidato_Prestamo
  Candidato_Prestamo Boolean
  // Campo para la Fecha de Registro
  Fecha_Registro String   @db.VarChar(10)
}

// Definición del modelo Libro
model Libro {
  // Campo de identificación para el ISBN
  ISBN   String   @id @db.VarChar(20)
  // Relación con el modelo Inventario
  inventario Inventario[]
  // Relación con el modelo PrestamoDevolucion
  prestamos PrestamoDevolucion[] // Agrega esta relación inversa
}

// Definición del modelo Revista
model Revista {
  // Campo de identificación para el ISSN
  ISSN   String   @id @db.VarChar(20)
  // Relación con el modelo Inventario
  inventario Inventario[]
  // Relación con el modelo PrestamoDevolucion
  prestamos PrestamoDevolucion[] // Agrega esta relación inversa
}

// Definición del modelo PrestamoDevolucion
model PrestamoDevolucion {
  // Campo de identificación autoincremental
  ID_Prestamo Int @id @default(autoincrement())
  // Campo para el ISBN, opcional
  ISBN String? @db.VarChar(20)
  // Campo para el ISSN, opcional
  ISSN String? @db.VarChar(20)
  // Relación con el modelo Revista
  revista Revista? @relation(fields: [ISSN], references: [ISSN])
  // Relación con el modelo Libro
  libro Libro? @relation(fields: [ISBN], references: [ISBN])
  // Campo para el ID de Usuario
  ID_Usuario Int
  // Relación con el modelo User
  User User @relation(fields: [ID_Usuario], references: [ID_Usuario])
  // Campo para el estado (booleano)
  Status Boolean
  // Campo para la Fecha de Prestamo
  Fecha_prestamo String @db.VarChar(20)
  // Campo para la Fecha de Devolución
  Fecha_devolucion String @db.VarChar(20)

  // Agrega la relación inversa para historial_prestamo
  historial_prestamo HistorialPrestamo[]
}

// Definición del modelo Inventario
model Inventario {
  // Campo de identificación autoincremental
  ID_Articulo   Int       @id @default(autoincrement())
  // Campo para el ISBN, opcional
  ISBN   String?   @db.VarChar(20)
  // Campo para el ISSN, opcional
  ISSN   String?   @db.VarChar(20)
  // Relación con el modelo Revista
  revista Revista? @relation(fields: [ISSN], references: [ISSN])
  // Relación con el modelo Libro
  libro Libro? @relation(fields: [ISBN], references: [ISBN])
  // Campo para la Sección de Biblioteca
  Seccion_Biblioteca String @db.VarChar(10)
  // Campo para el Número de Copias
  Numero_Copias String @db.VarChar(10)
  // Campo para el Número de Copias Disponibles
  Copias_Disponibles String @db.VarChar(10)
  // Campo para el Número de Copias Disponibles Mínimas
  Copias_Disponibles_minimas String @db.VarChar(10)
}

// Definición del modelo HistorialPrestamo
model HistorialPrestamo {
  // Campo para el ID de Usuario
  ID_Usuario Int
  // Relación con el modelo User
  User User @relation(fields: [ID_Usuario], references: [ID_Usuario])
  // Campo para el ID de Prestamo
  ID_Prestamo Int
  // Relación con el modelo PrestamoDevolucion
  PrestamoDevolucion PrestamoDevolucion @relation(fields: [ID_Prestamo], references: [ID_Prestamo])

  // Marca una combinación de campos como única
  @@id([ID_Usuario, ID_Prestamo])
}
